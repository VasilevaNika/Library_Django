{% extends 'library/base.html' %}

{% block content %}
<div class="row">
    <div class="col-md-4">
        <div class="card shadow-sm">
            {% if book.cover %}
            <img src="{{ book.cover.url }}" class="card-img-top" alt="{{ book.title }}">
            {% else %}
            <div class="card-img-top d-flex align-items-center justify-content-center" style="height: 400px; background: linear-gradient(135deg, #EBF5FB, #D6EAF8);">
                <span class="text-muted display-1">üìñ</span>
            </div>
            {% endif %}
            <div class="card-body text-center">
                {% if user.is_authenticated %}
                <form method="post" action="/toggle_favorite/{{ book.id }}/">
                    {% csrf_token %}
                    <button type="submit" 
                            class="btn {% if is_favorite %}btn-danger{% else %}btn-outline-danger{% endif %} btn-lg">
                        {% if is_favorite %}‚ô• –í –∏–∑–±—Ä–∞–Ω–Ω–æ–º{% else %}‚ô° –î–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ{% endif %}
                    </button>
                </form>
                {% else %}
                <a href="/login/" class="btn btn-outline-primary">–í–æ–π–¥–∏—Ç–µ, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ</a>
                {% endif %}
            </div>
            
            <!-- –ö–ù–û–ü–ö–ò –°–ö–ê–ß–ò–í–ê–ù–ò–Ø -->
            <div class="card-footer">
                <a href="/books/" class="btn btn-secondary btn-sm">‚Üê –ù–∞–∑–∞–¥ –∫ –∫–∞—Ç–∞–ª–æ–≥—É</a>
                
                {% if book.book_file %}
                <a href="{{ book.book_file.url }}" class="btn btn-success btn-sm" download>üì• –°–∫–∞—á–∞—Ç—å –∫–Ω–∏–≥—É</a>
                {% else %}
                <button class="btn btn-outline-secondary btn-sm" disabled>–§–∞–π–ª –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω</button>
                {% endif %}
            </div>
        </div>
    </div>

    <div class="col-md-8">
        <h1 class="display-5 text-dark">{{ book.title }}</h1>
        
        <div class="mb-3">
            <span class="h5 text-muted">–ê–≤—Ç–æ—Ä: </span>
            <span class="h5 text-dark">{{ book.author.name }}</span>
        </div>

        <div class="mb-4">
            {% for genre in book.genres.all %}
            <span class="badge bg-primary me-1">{{ genre.name }}</span>
            {% endfor %}
        </div>

        {% if book.description %}
        <div class="card shadow-sm">
            <div class="card-header">
                <h5 class="mb-0 text-dark">–û–ø–∏—Å–∞–Ω–∏–µ</h5>
            </div>
            <div class="card-body">
                <p class="card-text text-dark">{{ book.description|linebreaks }}</p>
            </div>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}